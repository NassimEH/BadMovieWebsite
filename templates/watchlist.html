{% extends "base.html" %}

{% block title %}Ma Liste | BadMovie{% endblock %}

{% block content %}
<header>
  <a href="{{ url_for('index') }}" class="logo">BadMovie<span class="logo-dot">.</span></a>
  <ul class="nav">
    <li>
      <a href="{{ url_for('index') }}" title="Accueil"><i class="fa fa-home" aria-hidden="true"></i> </a>
    </li>
    <li><a href="{{ url_for('movies.list_movies') }}">Tous nos films</a></li>
    <li><a href="{{ url_for('watchlist.show_watchlist') }}">Ma Liste</a></li>
    <li><a href="#">Pour vous</a></li>
  </ul>
  <div class="header-right">
    <div class="auth-buttons">
      {% if current_user.is_authenticated %}
      <a href="{{ url_for('auth.logout') }}" class="auth-btn">Déconnexion</a>
      <span class="user-name">{{ current_user.nom }}</span>
      {% else %}
      <a href="{{ url_for('auth.login') }}" class="auth-btn">Connexion</a>
      <a href="{{ url_for('auth.sign_up') }}" class="auth-btn auth-btn-outline">Inscription</a>
      {% endif %}
    </div>
  </div>
</header>

<div class="container" style="margin-top: 100px; margin-bottom: 50px;">
    <h2 class="center-align mb-4">Ma Watchlist</h2>

    {% if watchlist %}
        <div class="row">
            {% for item in watchlist %}
                <div class="col s12 m6 l3">
                    <div class="card hoverable h-100">
                        <div class="card-image">
                            {% if item.film.image %}
                                <img src="{{ item.film.image }}" alt="{{ item.film.name_movie }}">
                            {% else %}
                                <img src="{{ url_for('static', filename='images/default.jpg') }}" alt="Image par défaut">
                            {% endif %}
                            
                            <a href="{{ url_for('movies.movie_detail', tmdb_id=item.film.ID_film) }}" 
                               class="btn-floating halfway-fab waves-effect waves-light red">
                                <i class="fa fa-eye"></i>
                            </a>
                        </div>
                        <div class="card-content">
                            <span class="card-title activator grey-text text-darken-4 truncate" style="font-size: 1.2rem;">
                                {{ item.film.name_movie }}
                            </span>
                            <p>
                                {% if item.watched %}
                                    <span class="new badge green" data-badge-caption="Vu"></span>
                                {% else %}
                                    <span class="new badge orange" data-badge-caption="À voir"></span>
                                {% endif %}
                            </p>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="row center-align">
            <div class="col s12">
                <div class="card-panel teal lighten-4">
                    <span class="white-text">
                        Votre liste est vide pour le moment. 
                        <br>
                        <a href="{{ url_for('movies.list_movies') }}" class="btn waves-effect waves-light mt-3">
                            Découvrir des films
                        </a>
                    </span>
                </div>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}